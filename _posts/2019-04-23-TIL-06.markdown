---
layout: post
title:  "TIL-06 : ForeignKey, 데이터 참조무결성... 그리고 API..."
date:   2019-04-23 19:00:00 +0900
categories: TIL
---


## 오늘도 API에 영혼을 갈아 넣는 중...

어제 밤에 뭔가 빡빡하게 달렸던 과정을 오늘은 직접 하나하나 파헤치며 새롭게(?) 공부하고 있다. 
사용된 예제 코드 한줄 한줄에서 이게 왜? 무엇? 인지 조금이라도 알고 싶어서 파헤치며 독학아닌 독학을 하고 있는 중.
사용된 예제의 코드들에 대해 이해를 완전히 하는 건 아니지만,
적어도 python 예제 마지막 즈음에서 다루었던 model과 패키지의 구조들에 대해선 깊이 알아가는 과정인 것 같다.


## 어쩌다 데이터 무결성까지 파버렸다.

열심히 공부하는 가운데 db와 models.py 파일을 파악하는 와중에 잘 모르겠는 한줄이 등장.
`question = models.ForeignKey(Question, on_delete=models.CASCADE)`
이것을 알려면 ForeignKey가 뭔지 알아야할 것 같다. 설명을 통해 뭔지 대충 감은 오는데... 일단 검색.
`외래 키(Foreign Key)가 하나(또는 복수) 다른 테이블의 기본 키 필드를 가리키는 데이터의 참조 무결성(referential integrity)을 확인하기 위하여 사용된다. 즉, 허용된 데이터 값만 데이터베이스에 저장되는 것이다.`
라고 한다. 
음... 데이터 베이스간에 이어준다는 뜻인거 같은데... 저기 데이터의 참조 무결성이란 무엇인가?
- 무결성이란 데이터베이스에서 저장된 값들에 대하여 여러가지 제한을 통하여 데이터에 대한 신뢰를 보장하게 하여 일관성을 유지시켜주는 것
- 참조 무결성은 기본 키와 참조 키 간의 관계가 항상 유지됨을 보장합니다. 참조되는 테이블의 행을 이를 참조하는 참조키가 존재하는 한 삭제될 수 없고, 기본키도 변경될 수 없습니다.
라고 한다. 솔직히 뭔가 확 와닿지는 않는다. 맞는 말이라고는 생각한다. 참조하려는 애랑 참조 타겟 둘 중 하나라도 없으면 안되는게 맞으니까! 그리고 이 참조무결성에는 다음과 같은 조건이 있다고 한다.
- 기본 테이블에서 사용한 필드는 기본키이거나 고유 인덱스가 설정되어 있어야 합니다.
- 기본 테이블과 관계 테이블 둘 다 액세스 테이블이어야 합니다.
- 관계를 설정하는 테이블은 형식이 같아야 합니다.
음... 그런가 보다... 뭔지 알듯 말듯... 이 외에도 강화규칙이란게 있는데 대충 훑어만 보았다.


## ForeignKey 라는게 일단 뭔지는 알았다!

내가 꽤 궁금해했던 데이터 베이스 간을 연결하는 키 인 것이다!! 예를 들어 넷플릭스에 특정 영화의 리스트를 담고 있는 movie db와 사용자의 정보를 담고 있는 user db, 해당 사용자의 좋아요 리스트인 like db가 있다고 가정. 각각은 movie_id, user_id, like_id를 가지고 있으며, user db 는 like_id 를 ForeignKey로 가지고 있어서 자신의 좋아요 리스트를 가져올 수 있고, like_id는 각 영화의 movie_id를 ForeignKey로 가지고 있어 user가 좋아요를 누른 movie_id 리스트를 가지고 있는 것!!! 맞나? 맞으면 하트를 찍어주세요 예리님.


## 다시 장고로 돌아와서...

ForeignKey로 빠지게 했던 곳으로 돌아왔는데... 일단 왜 이게 있는지까지는 오케이... 근데 이놈의 클래스 중첩구조는 확 안들어온다... 이렇게만 적어두면 장고가 알아서 이어준다는 말이겠거니... 허허... 일단 주어진 과제 완료! miniter 붙이기 시작!!!

오늘은 일단 여기까지-!

